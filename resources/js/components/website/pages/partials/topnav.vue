<template>
    <div>

        <!-- header content -->

        <div class="searching">
            <div class="container">
                <div class="row">
                    <div class="col-8 text-center m-auto">
                        <div class="v1search_form">
                            <form action="#">
                                <input type="search" placeholder="Search Here...">
                                <button type="submit" class="cbtn1">Search</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="close_btn"> <i class="fal fa-times"></i>
            </div>
        </div>


        <div class="topbar white_bg" id="top">
            <div class="container">
                <div class="row">
                    <div class="col-md-6 col-lg-8 align-self-center">
                        <div class="trancarousel_area">
                            <p class="trand">Tranding</p>
                            <div class="trancarousel owl-carousel nav_style1">
                                <div class="trancarousel_item">
                                    <p><a href="#">Top 10 Best Movies of 2018 So Far: Great Movies</a>
                                    </p>
                                </div>
                                <div class="trancarousel_item">
                                    <p><a href="#">Top 10 Best Movies of 2018 So Far: Great Movies</a>
                                    </p>
                                </div>
                                <div class="trancarousel_item">
                                    <p><a href="#">Top 10 Best Movies of 2018 So Far: Great Movies</a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4 align-self-center">
                        <div class="top_date_social text-right">
                            <div class="paper_date">
                                <p>Thursday, March 26, 2020</p>
                            </div>
                            <div class="social1">
                                <ul class="inline">
                                    <li><a href="#"><i class="fab fa-twitter"></i></a>
                                    </li>
                                    <li><a href="#"><i class="fab fa-facebook-f"></i></a>
                                    </li>
                                    <li><a href="#"><i class="fab fa-youtube"></i></a>
                                    </li>
                                    <li><a href="#"><i class="fab fa-instagram"></i></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="border_black"></div>

        <div class="logo_area white_bg">
            <div class="container">
                <div class="row">
                    <div class="col-lg-4 align-self-center">
                        <div class="logo">
                            <a href="index-2.html">
                                <img src="assets/frontend/website/img/logo/logo.png" alt="image">
                            </a>
                        </div>
                    </div>
                    <div class="col-lg-8 align-self-center">
                        <div class="banner1">
                            <a href="#">
                                <img src="assets/frontend/website/img/bg/banner1.png" alt="">
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="main-menu" id="header">
            <a href="#top" class="up_btn up_btn1"><i class="far fa-chevron-double-up"></i></a>
            <div class="main-nav clearfix is-ts-sticky">
                <div class="container">
                    <div class="row justify-content-between">
                        <div class="col-6 col-lg-8">
                            <div class="newsprk_nav stellarnav">
                                <ul id="newsprk_menu">
                                    <li><a href="#">Home <i class="fal fa-angle-down"></i></a>
                                        <ul>
                                            <li><a href="index-2.html">Home 1 <i class="fal fa-angle-right"></i></a>
                                                <ul>
                                                    <li><a href="index2.html">Version 1</a>
                                                    </li>
                                                    <li><a href="index3.html">Version 2</a>
                                                    </li>
                                                    <li><a href="index4.html">Version 3</a>
                                                    </li>
                                                    <li><a href="index5.html">Version 4</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a href="dark/index.html">Home 2 <i class="fal fa-angle-right"></i></a>
                                                <ul>
                                                    <li><a href="dark/index2.html">Version 1</a>
                                                    </li>
                                                    <li><a href="dark/index3.html">Version 2</a>
                                                    </li>
                                                    <li><a href="dark/index4.html">Version 3</a>
                                                    </li>
                                                    <li><a href="dark/index5.html">Version 4</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a href="theme-3/index.html">Home 3 <i
                                                        class="fal fa-angle-right"></i></a>
                                                <ul>
                                                    <li><a href="theme-3/index2.html">Version 1</a>
                                                    </li>
                                                    <li><a href="theme-3/index3.html">Version 2</a>
                                                    </li>
                                                    <li><a href="theme-3/index4.html">Version 3</a>
                                                    </li>
                                                    <li><a href="theme-3/index5.html">Version 4</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a href="theme-4/index.html">Home 4 <i
                                                        class="fal fa-angle-right"></i></a>
                                                <ul>
                                                    <li><a href="theme-4/index2.html">Version 1</a>
                                                    </li>
                                                    <li><a href="theme-4/index3.html">Version 2</a>
                                                    </li>
                                                    <li><a href="theme-4/index4.html">Version 3</a>
                                                    </li>
                                                    <li><a href="theme-4/index5.html">Version 4</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a href="#">Pages <i class="fal fa-angle-down"></i></a>
                                        <ul>
                                            <li><a href="about.html">About</a>
                                            </li>
                                            <li><a href="archive.html">Archive</a>
                                            </li>
                                            <li><a href="contact.html">Contact Us</a>
                                            </li>
                                            <li><a href="404.html">404</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a href="#">Posts <i class="fal fa-angle-down"></i></a>
                                        <ul>
                                            <li><a href="#">General Posts <i class="fal fa-angle-right"></i></a>
                                                <ul>
                                                    <li><a href="post1.html">Post 1</a>
                                                    </li>
                                                    <li><a href="post2.html">Post 2</a>
                                                    </li>
                                                    <li><a href="post3.html">Post 3</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a href="#">Video Posts <i class="fal fa-angle-right"></i></a>
                                                <ul>
                                                    <li><a href="video_post1.html">Video Style 1</a>
                                                    </li>
                                                    <li><a href="video_post2.html">Video Style 2</a>
                                                    </li>
                                                    <li><a href="video_post3.html">Video Style 3</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a href="#">Audio Posts <i class="fal fa-angle-right"></i></a>
                                                <ul>
                                                    <li><a href="audio_post1.html">Audio Style 1</a>
                                                    </li>
                                                    <li><a href="audio_post2.html">Audio Style 2</a>
                                                    </li>
                                                    <li><a href="audio_post3.html">Audio Style 3</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a href="#">Sidebars <i class="fal fa-angle-right"></i></a>
                                                <ul>
                                                    <li><a href="post1.html">Right Sidebar</a>
                                                    </li>
                                                    <li><a href="left_post2.html">Left Sidebar</a>
                                                    </li>
                                                    <li><a href="post2.html">No Sidebar <i
                                                                class="fal fa-angle-right"></i></a>
                                                        <ul>
                                                            <li><a href="#">Simple menu</a></li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a href="#">Categories <i class="fal fa-angle-down"></i></a>
                                        <ul>
                                            <li class="active"><a href="business.html">Business</a>
                                            </li>
                                            <li><a href="entertainment.html">Entertainment</a>
                                            </li>
                                            <li><a href="feature.html">Features</a>
                                            </li>
                                            <li><a href="sports.html">Sports</a>
                                            </li>
                                            <li><a href="trending.html">Trending</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a href="#world">World</a></li>
                                    <li><a href="#sports">Sports</a></li>
                                    <li><a href="contact.html">Contact</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-6 col-lg-4 align-self-center">
                            <div class="menu_right">
                                <div class="users_area">
                                    <ul class="inline">
                                        <li class="search_btn"><i class="far fa-search"></i>
                                        </li>
                                        <li>
                                            <a href="javascript:void();" v-if="loggedIn != true" class=" "
                                                data-toggle="modal" data-target="#sign_in"><i
                                                    class="w-icon-account"></i>Sign In</a>
                                            <i v-if="loggedIn == true" class="fal fa-user-circle"></i>
                                        </li>
                                    </ul>
                                </div>
                                <div class="lang d-none d-xl-block">
                                    <ul>
                                        <li><a href="#">English <i class="far fa-angle-down"></i></a>
                                            <ul>
                                                <li><a href="#">Spanish</a>
                                                </li>
                                                <li><a href="#">China</a>
                                                </li>
                                                <li><a href="#">Hindi</a>
                                                </li>
                                                <li><a href="#">Corian</a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                                <div class="temp d-none d-lg-block">
                                    <div class="temp_wap">
                                        <div class="temp_icon">
                                            <img src="assets/frontend/website/img/icon/temp.png" alt="">
                                        </div>
                                        <h3 class="temp_count">13</h3>

                                        <p>San Francisco</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- header content -->



        <!-- button -->


        <!-- sign_in  -->
        <div class="modal fade" id="sign_in" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content cs_modal">
                    <div class="modal-header">
                        <h5 class="modal-title">Login</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true" class="ti-close"></span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form role="form" @submit.prevent="login()">

                            <div class="form-group">
                                <label>Username or email address *</label>
                                <input type="text" class="form-control" name="username" v-model="form.username"
                                    :class="{ 'is-invalid': form.errors.has('username') }">
                            </div>
                            <div class="form-group mb-0">
                                <label>Password *</label>
                                <input type="text" class="form-control" name="password" id="password"
                                    v-model="form.password" :class="{ 'is-invalid': form.errors.has('password') }">
                            </div>

                            <button type='submit' class="btn btn-primary">Sign In</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>


    </div>
</template>
<script>
    export default {
        data() {
            return {
                loggedIn: false,
                USER: {},
                verify: 1,
                form: new Form({
                    name: '',
                    username: '',
                    email: '',
                    password: '',
                    password_confirmation: '',
                })
            }
        },
        methods: {
            login() {
                this.$Progress.start()
                this.form.post('/api/auth/login')
                    .then((result) => {
                        console.log(result);
                        this.$store.commit('SET_USER', result.data)
                        this.loggedIn = true;
                        this.$Progress.finish()
                        if (result.data.error) {
                            this.$Progress.finish()
                            Toast.fire({
                                icon: 'error',
                                title: result.data.error
                            })
                        }
                        if (result.data.user.user_type == 1) {
                            Toast.fire({
                                icon: 'success',
                                title: result.data.success
                            })
                            // console.log(result.data)
                             window.location.href = "/admin/dashboard"
                        }
                        if (result.data.user.user_type == 4) {
                            if (result.data.user.email_verify == 1) {
                                if (this.$route.path == '/') {
                                    Toast.fire({
                                        icon: 'success',
                                        title: result.data.success
                                    })
                                    window.location.href = "/dashboard"
                                } else {
                                    window.location.reload()
                                }
                            } else {
                                this.verify = false;
                            }
                        }
                    })
                    .catch((result) => {
                        console.log(result)
                    })

            },
            Loggedin() {
                if (this.USER != null) {
                    if (User.loggedIn(this.USER.access_token)) {
                        this.loggedInAdmin = true;
                        this.loggedIn = true;
                    } else {
                        this.loggedIn = false;
                        this.loggedInAdmin = false;
                    }
                }
            }
        },
        created() {
            this.USER = this.$store.getters.getUser;
            this.Loggedin();
        },
    }

</script>
